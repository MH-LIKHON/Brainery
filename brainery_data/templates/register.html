{% extends "base.html" %}

{% block content %}

<style>
/* =======================================================
   REGISTER PAGE
   ======================================================= */

/* -------------------------------
   Global Resets
   ------------------------------- */
/* Reset default margins and paddings */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Arial', sans-serif;
}

/* Body Styling */
body {
    background: #f8f9fa;
}

/* -------------------------------
   Page Layout
   ------------------------------- */
/* Page container for register form */
.register-container {
    max-width: 700px;
    margin: 50px auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    text-align: center;
    transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
}

/* Smooth fade-in effect */
.register-container.show {
    opacity: 1;
    transform: translateY(0);
}

.register-container.hidden {
    opacity: 0;
    transform: translateY(-10px);
}

/* -------------------------------
   Titles
   ------------------------------- */
/* Register Page Title */
.register-container h2 {
    font-weight: bold;
    margin-bottom: 20px;
}

/* -------------------------------
   Package Selection Layout
   ------------------------------- */
/* Package selection container */
.package-selection {
    display: flex;
    justify-content: space-between;
    gap: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

/* -------------------------------
   Package Cards
   ------------------------------- */
/* Individual package card */
.package {
    flex: 1;
    padding: 20px;
    background: #fff;
    border: 2px solid #20c997;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease-in-out;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    text-align: center;
    min-width: 200px;
    position: relative;
}

/* Hover effect & selection */
.package:hover,
.package.selected {
    background: #20c997;
    color: white;
    transform: scale(1.05);
    box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.2);
}

/* Small pulse effect when selected */
.package.selected::after {
    content: "âœ”";
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 20px;
    font-weight: bold;
    color: white;
}

/* -------------------------------
   Form Sections
   ------------------------------- */
/* Smooth fade-in effect */
.step-section {
    display: none;
    opacity: 0;
    transition: opacity 0.4s ease-in-out;
}

.step-section.active {
    display: block;
    opacity: 1;
}

/* -------------------------------
   Form Input Fields
   ------------------------------- */
/* Form group wrapper */
.form-group {
    margin-bottom: 15px;
    position: relative;
}

/* Input Labels */
label {
    font-weight: bold;
    display: block;
}

/* Input Fields */
input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    transition: border 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
}

/* Input focus effect */
input:focus {
    border-color: #20c997;
    box-shadow: 0px 0px 8px rgba(32, 201, 151, 0.3);
    outline: none;
}

/* -------------------------------
   Payment Section
   ------------------------------- */
/* Smooth fade-in effect */
.payment-section {
    display: none;
    opacity: 0;
    transition: opacity 0.4s ease-in-out;
}

.payment-section.active {
    display: block;
    opacity: 1;
}

/* -------------------------------
   Promo Code Section
   ------------------------------- */
/* Promo code input */
.promo-code input {
    width: 70%;
    display: inline-block;
}

/* Promo code apply button */
.promo-code button {
    width: 28%;
    background: #20c997;
    color: white;
    border: none;
    padding: 8px;
    cursor: pointer;
    transition: background 0.3s ease-in-out;
}

/* Hover effect */
.promo-code button:hover {
    background: #198754;
}

/* Promo Message */
#promo-message {
    margin-top: 5px;
    font-size: 14px;
    transition: opacity 0.3s ease-in-out, color 0.3s ease-in-out;
}

/* -------------------------------
   Submit Button
   ------------------------------- */
/* Main submit button */
.submit-btn {
    background: #20c997;
    color: white;
    border: none;
    padding: 12px;
    width: 100%;
    cursor: pointer;
    font-size: 16px;
    margin-top: 10px;
    border-radius: 5px;
    transition: background 0.3s ease-in-out, transform 0.2s ease-in-out;
}

/* Hover effect */
.submit-btn:hover {
    background: #198754;
    transform: scale(1.02);
}

/* Click effect */
.submit-btn:active {
    transform: scale(0.98);
}

/* -------------------------------
   Funny Confirmation Message
   ------------------------------- */
/* Hidden by default */
.success-message {
    display: none;
    font-size: 22px;
    font-weight: bold;
    text-align: center;
    color: #20c997;
    padding: 50px;
    transition: opacity 0.3s ease-in-out;
}

/* -------------------------------
   Mobile & Tablet View (Responsive)
   ------------------------------- */
/* Adjust Navbar for Mobile (screens smaller than 768px) */
@media (max-width: 768px) {
    .register-container {
        max-width: 95%;
        padding: 20px;
    }

    .package-selection {
        flex-direction: column;
        gap: 10px;
    }

    .package {
        width: 100%;
    }

    input {
        font-size: 14px;
    }

    .submit-btn {
        font-size: 14px;
        padding: 10px;
    }
}

/* Adjust Navbar for Mobile (screens smaller than 576px) */
@media (max-width: 480px) {
    .register-container {
        padding: 15px;
    }

    h2 {
        font-size: 22px;
    }

    .submit-btn {
        font-size: 14px;
    }
}

</style>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-messages">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<!-- Register Page -->
<div class="register-container" id="register-form">
    <h2>Choose Your Brainery Plan</h2>

    <!-- Package Selection -->
    <div class="package-selection">
        <div class="package" data-price="10" data-name="Weekly Plan">
            <h4>Weekly Plan - Â£10</h4>
            <ul>
                <li>ðŸ“š Access to all courses</li>
                <li>ðŸ“… 7-day validity</li>
                <li>ðŸ’¬ Community Support</li>
            </ul>
        </div>
        <div class="package" data-price="30" data-name="Monthly Plan">
            <h4>Monthly Plan - Â£30</h4>
            <ul>
                <li>ðŸ“š Access to all courses</li>
                <li>ðŸ“… 30-day validity</li>
                <li>ðŸ’¬ Priority Support</li>
            </ul>
        </div>
        <div class="package" data-price="100" data-name="Annual Plan">
            <h4>Annual Plan - Â£100</h4>
            <ul>
                <li>ðŸ“š Access to all courses</li>
                <li>ðŸ“… 1-year validity</li>
                <li>ðŸŽ“ Certification on Completion</li>
            </ul>
        </div>
    </div>

    <!-- Personal Info Step -->
    <form method="POST" action="{{ url_for('register.register_user') }}" class="step-section" id="personal-info">
        {{ form.hidden_tag() }}  <!-- Automatically handles CSRF token -->
    
        <h4>Tell us about yourself</h4>
    
        <div class="form-group">
            <label for="first-name">First Name</label>
            {{ form.first_name(class="form-control", id="first-name", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="last-name">Last Name</label>
            {{ form.last_name(class="form-control", id="last-name", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="dob">Date of Birth</label>
            {{ form.dob(class="form-control", id="dob", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="email">Email Address</label>
            {{ form.email(class="form-control", id="email", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="phone">Phone Number</label>
            {{ form.phone(class="form-control", id="phone", required=True) }}
        </div>
    
        <h5>Billing Address</h5>
    
        <div class="form-group">
            <label for="address-line1">Address Line 1</label>
            {{ form.address_line1(class="form-control", id="address-line1", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="address-line2">Address Line 2 (Optional)</label>
            {{ form.address_line2(class="form-control", id="address-line2") }}
        </div>
    
        <div class="form-group">
            <label for="city">City</label>
            {{ form.city(class="form-control", id="city", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="country">Country</label>
            {{ form.country(class="form-control", id="country", required=True) }}
        </div>
    
        <div class="form-group">
            <label for="postcode">Postcode</label>
            {{ form.postcode(class="form-control", id="postcode", required=True) }}
        </div>
    
        <button type="submit" class="submit-btn" id="next-payment">Next: Payment</button>
    </form>    
</div>

<!-- Funny Success Message -->
<div class="success-message" id="success-message">
    ðŸŽ‰ Woohoo! Youâ€™re now officially part of the **Brainery Family!**  
    ðŸ“¬ Check your email for your account activation link.  
    ðŸ¤– If you donâ€™t see it, maybe itâ€™s lost in the **Matrix** (or spam folder).  
    ðŸš€ Happy Learning!  
</div>

<script>
// Handle package selection
document.querySelectorAll(".package").forEach(item => {
    item.addEventListener("click", function() {
        // Remove selection from other packages
        document.querySelectorAll(".package").forEach(p => p.classList.remove("selected"));
        
        // Add selection with animation
        this.classList.add("selected");
        this.style.transform = "scale(1.05)";
        setTimeout(() => {
            this.style.transform = "scale(1)";
        }, 200);

        // Show personal info section
        const personalInfo = document.getElementById("personal-info");
        personalInfo.style.opacity = 0;
        personalInfo.style.display = "block";
        setTimeout(() => {
            personalInfo.style.opacity = 1;
        }, 200);
    });
});

// Password validation
document.getElementById("complete-registration").addEventListener("click", function(event) {
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirm-password").value;

    if (password !== confirmPassword) {
        event.preventDefault();
        alert("Passwords do not match!");
    }
});

// Promo code functionality
function applyPromoCode() {
    const promoInput = document.getElementById("promo-code");
    const cardPayment = document.getElementById("card-payment");
    const promoMessage = document.getElementById("promo-message");

    if (promoInput.value.trim() === "CI25MP3") {
        cardPayment.style.opacity = 0;
        setTimeout(() => {
            cardPayment.style.display = "none";
        }, 300);

        promoMessage.innerText = "Promo code applied! Card payment hidden.";
        promoMessage.style.color = "green";
        promoMessage.style.opacity = 1;
    } else {
        promoMessage.innerText = "Invalid promo code. Try again!";
        promoMessage.style.color = "red";
        promoMessage.style.opacity = 1;
    }
}

// Ensure promo message is hidden initially
document.addEventListener("DOMContentLoaded", () => {
    const promoMessage = document.createElement("p");
    promoMessage.id = "promo-message";
    promoMessage.style.opacity = 0;
    promoMessage.style.transition = "opacity 0.3s ease";
    document.getElementById("promo-code").insertAdjacentElement("afterend", promoMessage);
});
</script>

{% endblock %}
 